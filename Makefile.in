export CC=gcc
export CFLAGS=-std=c99 -pthread -O2 -fstrict-aliasing -fomit-frame-pointer -D_FILE_OFFSET_BITS=64 -D_BSD_SOURCE -pedantic -Werror -Wstrict-aliasing -Wchar-subscripts -Wimplicit -Wsequence-point -Wcast-align -Wstrict-prototypes -Wno-unused-result
export LDFLAGS=-pthread

all: findex ffind
	gzip < ffind.1 > ffind.1.gz

findex:
	$(MAKE) -C src $@

ffind:
	$(MAKE) -C src $@

check: clean
	$(MAKE) -C test check

clean:
	$(MAKE) -C src $@
	$(MAKE) -C test $@
	rm -f ffind.1.gz

mrproper: clean
	rm -f Makefile
	rm -f ffind.1
	rm -f src/ffind.c

install: all
	cp src/findex /usr/local/bin/
	cp src/ffind /usr/local/bin/
	cp ffind.1.gz /usr/share/man/man1/

uninstall:
	rm -f /usr/local/bin/findex
	rm -f /usr/local/bin/ffind
	rm -f /usr/share/man/man1/ffind.1.gz
